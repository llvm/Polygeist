<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Enzyme AD</title><meta name=description content="Polygeist MLIR Polyhedral Compiler for C/C++"><meta name=generator content="Hugo 0.74.3"><link href=https://polygeist.mit.edu/index.xml rel=alternate type=application/rss+xml><link rel=canonical href=https://polygeist.mit.edu/><link rel=stylesheet href=https://polygeist.mit.edu/css/theme.css><script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script><link rel=stylesheet href=https://polygeist.mit.edu/css/chroma.min.css><script src=https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js></script><script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script><script src=https://polygeist.mit.edu/js/bundle.js></script><link rel=icon href=/favicon.ico type=image/x-icon><script async src="https://www.googletagmanager.com/gtag/js?id=G-SBS5VNKHC1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-SBS5VNKHC1');</script><style>:root{}</style></head><body><div class=container><header><h1><div><a href=/ style=text-decoration:none;color:#000><img src=https://polygeist.mit.edu//logo.svg width=40px align=absmiddle>
Enzyme AD</a></div></h1><p class=description>Polygeist MLIR Polyhedral Compiler for C/C++</p></header><div class=global-menu><nav><ul><li><a href>Community</a></li><li><a href=https://github.com/wsmoses/Polygeist>Source</a></li><li><a href=https://github.com/wsmoses/Polygeist/issues>Bugs</a></li><li><a href=/getting_started/Faq/>FAQ</a></li></ul></nav></div><div class=content-container><main><h1 id=polygeist-overview>Polygeist Overview</h1><p>Polygeist is a new compilation flow that connects the MLIR compiler
infrastructure to cutting edge polyhedral optimization tools. Our goal with
Polygeist is to connect decades of research in the polyhedral model to the new
MLIR compiler infrastructure.</p><p>The following shows a simple example where we use Polygesit to enter
the MLIR lowering pipeline and raise the C code to the Affine dialect.</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>mlir-clang gemm.c --function<span class=o>=</span>matmul --raise-scf-to-affine
</code></pre></div><div class=highlight><pre class=chroma><code class=language-c data-lang=c><span class=cp>#define N 200;
</span><span class=cp>#define M 300
</span><span class=cp>#define K 400
</span><span class=cp>#define DATA_TYPE float
</span><span class=cp></span>
<span class=kt>void</span> <span class=nf>matmul</span><span class=p>(</span><span class=n>DATA_TYPE</span> <span class=n>A</span><span class=p>[</span><span class=n>N</span><span class=p>][</span><span class=n>K</span><span class=p>],</span> <span class=n>DATA_TYPE</span> <span class=n>B</span><span class=p>[</span><span class=n>K</span><span class=p>][</span><span class=n>M</span><span class=p>],</span> <span class=n>DATA_TYPE</span> <span class=n>C</span><span class=p>[</span><span class=n>N</span><span class=p>][</span><span class=n>M</span><span class=p>])</span> <span class=p>{</span>
  <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>k</span><span class=p>;</span>
  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>N</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>M</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
      <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>K</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>C</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>*</span> <span class=n>B</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
      <span class=p>}</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><div class=highlight><pre class=chroma><code class=language-mlir data-lang=mlir><span class=kt>func</span> <span class=nf>@matmul</span><span class=p>(</span><span class=nv>%arg0</span><span class=p>:</span> <span class=kt>memref</span><span class=p>&lt;</span><span class=m>?x400x</span><span class=k>f32</span><span class=p>&gt;,</span> <span class=nv>%arg1</span><span class=p>:</span> <span class=kt>memref</span><span class=p>&lt;</span><span class=m>?x300x</span><span class=k>f32</span><span class=p>&gt;,</span> <span class=nv>%arg2</span><span class=p>:</span> <span class=kt>memref</span><span class=p>&lt;</span><span class=m>?x300x</span><span class=k>f32</span><span class=p>&gt;)</span> <span class=p>{</span>
  affine<span class=p>.</span>for <span class=nv>%arg3</span> <span class=p>=</span> <span class=m>0</span> to <span class=m>200</span> <span class=p>{</span>
    affine<span class=p>.</span>for <span class=nv>%arg4</span> <span class=p>=</span> <span class=m>0</span> to <span class=m>300</span> <span class=p>{</span>
      affine<span class=p>.</span>for <span class=nv>%arg5</span> <span class=p>=</span> <span class=m>0</span> to <span class=m>400</span> <span class=p>{</span>
        <span class=nv>%0</span> <span class=p>=</span> affine<span class=p>.</span>load <span class=nv>%arg0</span><span class=p>[</span><span class=nv>%arg3</span><span class=p>,</span> <span class=nv>%arg5</span><span class=p>]</span> <span class=p>:</span> <span class=kt>memref</span><span class=p>&lt;</span><span class=m>?x400x</span><span class=k>f32</span><span class=p>&gt;</span>
        <span class=nv>%1</span> <span class=p>=</span> affine<span class=p>.</span>load <span class=nv>%arg1</span><span class=p>[</span><span class=nv>%arg5</span><span class=p>,</span> <span class=nv>%arg4</span><span class=p>]</span> <span class=p>:</span> <span class=kt>memref</span><span class=p>&lt;</span><span class=m>?x300x</span><span class=k>f32</span><span class=p>&gt;</span>
        <span class=nv>%2</span> <span class=p>=</span> mulf <span class=nv>%0</span><span class=p>,</span> <span class=nv>%1</span> <span class=p>:</span> <span class=k>f32</span>
        <span class=nv>%3</span> <span class=p>=</span> affine<span class=p>.</span>load <span class=nv>%arg2</span><span class=p>[</span><span class=nv>%arg3</span><span class=p>,</span> <span class=nv>%arg4</span><span class=p>]</span> <span class=p>:</span> <span class=kt>memref</span><span class=p>&lt;</span><span class=m>?x300x</span><span class=k>f32</span><span class=p>&gt;</span>
        <span class=nv>%4</span> <span class=p>=</span> addf <span class=nv>%3</span><span class=p>,</span> <span class=nv>%2</span> <span class=p>:</span> <span class=k>f32</span>
        affine<span class=p>.</span>store <span class=nv>%4</span><span class=p>,</span> <span class=nv>%arg2</span><span class=p>[</span><span class=nv>%arg3</span><span class=p>,</span> <span class=nv>%arg4</span><span class=p>]</span> <span class=p>:</span> <span class=kt>memref</span><span class=p>&lt;</span><span class=m>?x300x</span><span class=k>f32</span><span class=p>&gt;</span>
      <span class=p>}</span>
    <span class=p>}</span>
  <span class=p>}</span>
  <span class=kt>return</span>
<span class=p>}</span>
</code></pre></div><h2 id=components>Components</h2><p>Polygeist is composed of three pieces:</p><ul><li>A frontend to emit MLIR SCF from a broad range of exisiting C or C++ code.</li><li>A set of compilation passes to raise SCF constructs to the Affine dialect.</li><li>A set of compilation passes to have a bi-directional conversion between MLIR and OpenScop exchange format.</li></ul><h2 id=more-resources>More resources</h2><p>For more information on Polygeist, please see:</p><ul><li>The Polygeist
<a href=/Installation/>installation guide</a></li></ul><h2 id=citing-polygeist>Citing Polygeist</h2><p>To cite Polygeist, please cite the following:</p><pre><code>@inproceedings{polygeistPACT,
  title = {Polygeist: Raising C to Polyhedral MLIR},
  author = {Moses, William S. and Chelini, Lorenzo and Zhao, Ruizhe and Zinenko, Oleksandr},
  booktitle = {Proceedings of the ACM International Conference on Parallel Architectures and Compilation Techniques},
  numpages = {12},
  location = {Virtual Event},
  series = {PACT '21},
  publisher = {Association for Computing Machinery},
  year = {2021},
  address = {New York, NY, USA},
  keywords = {Polygeist, MLIR, Polyhedral, LLVM, Compiler, C++, Pluto, Polly, OpenScop, Parallel, OpenMP, Affine, Raising, Transformation, Splitting, Automatic-Parallelization, Reduction, Polybench},
}
</code></pre><nav class=pagination><a class="nav nav-next" href=/Installation/ title=Installation>Next - Installation <i class="fas fa-arrow-right" aria-hidden=true></i></a></nav><div class=edit-meta><br></div><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme by <a href=https://themes.gohugo.io/hugo-theme-techdoc/>TechDoc</a>. Designed by <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p></footer></main><div class=sidebar><nav class=slide-menu><ul><li class=active><a href=https://polygeist.mit.edu/>Home</a></li><li><a href=/Installation/>Installation</a></li><li><a href=/charter/>Charter</a></li><li class=has-sub-menu><a href=/getting_started/>Getting Started<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=/getting_started/Use_Polymer/>How to use Polymer</a></li><li><a href=/getting_started/Faq/>FAQ</a></li></ul></li><li><a href=/talks/>Talks and Related Publications</a></li></ul></nav><div class=sidebar-footer></div></div></div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20><span class="fa-layers fa-fw"><i class="fas fa-circle"></i><i class="fas fa-arrow-circle-up"></i></span></a></div></body></html>